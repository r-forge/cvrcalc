{
    "contents" : "\\name{dorica}\n\\alias{dorica}\n%- Also NEED an '\\alias' for EACH other topic documented here.\n\\title{\n%%  ~~function to do ... ~~\n}\n\\description{\n%%  ~~ A concise (1-5 lines) description of what the function does. ~~\n}\n\\usage{\ndorica()\n}\n%- maybe also 'usage' for other objects documented here.\n\\details{\n%%  ~~ If necessary, more details than the description above ~~\n}\n\\value{\n%%  ~Describe the value returned\n%%  If it is a LIST, use\n%%  \\item{comp1 }{Description of 'comp1'}\n%%  \\item{comp2 }{Description of 'comp2'}\n%% ...\n}\n\\references{\n%% ~put references to the literature/web site here ~\n}\n\\author{\n%%  ~~who you are~~\n}\n\\note{\n%%  ~~further notes~~\n}\n\n%% ~Make other sections like Warning with \\section{Warning }{....} ~\n\n\\seealso{\n%% ~~objects to See Also as \\code{\\link{help}}, ~~~\n}\n\\examples{\n##---- Should be DIRECTLY executable !! ----\n##-- ==>  Define data, use random,\n##--\tor do  help(data=index)  for the standard data sets.\n\n## The function is currently defined as\nfunction () \n{\n    file.import = gfile(mensaje_excel, filter = \"*.*\")\n    wb.datos = loadWorkbook(file.import, create = FALSE)\n    misdatos.full = readWorksheet(wb.datos, sheet = 1)\n    misdatos = na.omit(misdatos.full)\n    coloca_reg = data.frame(row.names(misdatos))\n    num_regs = dim(misdatos)[1]\n    resultados = 0\n    registro = 1\n    for (registro in 1:num_regs) {\n        sexo = misdatos[registro, 1]\n        edad = misdatos[registro, 2]\n        colesterol = misdatos[registro, 3]\n        hdl = misdatos[registro, 4]\n        tas = misdatos[registro, 5]\n        tad = misdatos[registro, 6]\n        fuma = misdatos[registro, 7]\n        diabetes = misdatos[registro, 8]\n        hipertrofia = misdatos[registro, 9]\n        if (colesterol < 160) \n            col1 <- 1\n        else col1 <- 0\n        if (colesterol >= 160 & colesterol < 200) \n            col2 <- 1\n        else col2 <- 0\n        if (colesterol >= 200 & colesterol < 240) \n            col3 <- 1\n        else col3 <- 0\n        if (colesterol >= 240 & colesterol < 280) \n            col4 <- 1\n        else col4 <- 0\n        if (colesterol >= 280) \n            col5 <- 1\n        else col5 <- 0\n        if (hdl < 35) \n            hdl1 <- 1\n        else hdl1 <- 0\n        if (hdl >= 35 & hdl < 45) \n            hdl2 <- 1\n        else hdl2 <- 0\n        if (hdl >= 45 & hdl < 50) \n            hdl3 <- 1\n        else hdl3 <- 0\n        if (hdl >= 50 & hdl < 60) \n            hdl4 <- 1\n        else hdl4 <- 0\n        if (hdl >= 60) \n            hdl5 <- 1\n        else hdl5 <- 0\n        t1 <- 0\n        t2 <- 0\n        t3 <- 0\n        t4 <- 0\n        t5 <- 0\n        if (tas < 120 & tad < 80) \n            t1 <- 1\n        else t1 <- 0\n        if (tas < 120) {\n            if (tad >= 80 & tad < 85) \n                t2 <- 1\n            else t2 <- 0\n            if (tad >= 85 & tad < 90) \n                t3 <- 1\n            else t3 <- 0\n            if (tad >= 90 & tad < 100) \n                t4 <- 1\n            else t4 <- 0\n            if (tad >= 100) \n                t5 <- 1\n            else t5 <- 0\n        }\n        if (tas >= 120 & tas < 130) {\n            if (tad < 85) \n                t2 <- 1\n            else t2 <- 0\n            if (tad >= 85 & tad < 90) \n                t3 <- 1\n            else t3 <- 0\n            if (tad >= 90 & tad < 100) \n                t4 <- 1\n            else t4 <- 0\n            if (tad >= 100) \n                t5 <- 1\n            else t5 <- 0\n        }\n        if (tas >= 130 & tas < 140) {\n            if (tad < 90) \n                t3 <- 1\n            else t3 <- 0\n            if (tad >= 90 & tad < 100) \n                t4 <- 1\n            else t4 <- 0\n            if (tad >= 100) \n                t5 <- 1\n            else t5 <- 0\n        }\n        if (tas >= 140 & tas < 160) {\n            if (tad < 100) \n                t4 <- 1\n            else t4 <- 0\n            if (tad >= 100) \n                t5 <- 1\n            else t5 <- 0\n        }\n        if (tas >= 160) {\n            t5 <- 1\n        }\n        if (sexo == 0) {\n            l = 0.04826 * edad - 0.65945 * col1 + 0 * col2 + \n                0.17692 * col3 + 0.50539 * col4 + 0.65713 * col5 + \n                0.49744 * hdl1 + 0.2431 * hdl2 + 0 * hdl3 - 0.05107 * \n                hdl4 - 0.4866 * hdl5 - 0.00226 * t1 + 0 * t2 + \n                0.2832 * t3 + 0.52168 * t4 + 0.61859 * t5 + 0.42839 * \n                diabetes + 0.52337 * fuma\n        }\n        if (sexo == 1) {\n            l = 0.33766 * edad - 0.00268 * (edad^2) - 0.26138 * \n                col1 + 0 * col2 + 0.20771 * col3 + 0.24385 * \n                col4 + 0.53513 * col5 + 0.84312 * hdl1 + 0.37796 * \n                hdl2 + 0.19785 * hdl3 + 0 * hdl4 - 0.42951 * \n                hdl5 - 0.53363 * t1 + 0 * t2 - 0.06773 * t3 + \n                0.26288 * t4 + 0.46573 * t5 + 0.59626 * diabetes + \n                0.29246 * fuma\n        }\n        if (sexo == 0) {\n            g = 2.5679\n        }\n        if (sexo == 1) {\n            g = 9.2912\n        }\n        dif = l - g\n        exponencial = exp(dif)\n        if (sexo == 0) {\n            superv10 = 0.945\n        }\n        if (sexo == 1) {\n            superv10 = 0.979\n        }\n        h0 = -log(superv10)\n        exponente = h0 * exponencial\n        p = 1 - exp((-1) * exponente)\n        if (edad >= 25 && edad <= 64) \n            resultados[registro] = p\n        else resultados[registro] = NA\n    }\n    matriz_final = data.frame(coloca_reg, resultados)\n    matriz_final2 = na.omit(matriz_final)\n    posicion = dim(misdatos.full)[1]\n    lista_pos = data.frame(rep(1:posicion))\n    matriz_final3 = merge(lista_pos, matriz_final2, by.x = \"rep.1.posicion.\", \n        by.y = \"row.names.misdatos.\", all = \"TRUE\")\n    wb.result = loadWorkbook(file.import, create = FALSE)\n    appendWorksheet(wb.result, matriz_final3, sheet = 2, header = TRUE, \n        rownames = FALSE)\n    saveWorkbook(wb.result, file.import)\n    gmessage(mensaje_fin, title = \"OK\")\n  }\n}\n% Add one or more standard keywords, see file 'KEYWORDS' in the\n% R documentation directory.\n\\keyword{ ~kwd1 }\n\\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line\n",
    "created" : 1362518989835.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3225215879",
    "id" : "7450F093",
    "lastKnownWriteTime" : 1362491362,
    "path" : "C:/Users/LeugimSan/Dropbox/Programacion_SCORES/cvrcalc/cvrcalc/man/dorica.Rd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_doc"
}